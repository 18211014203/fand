$(function(){var a=0,t=function(a,t,e){var l=a,i=l.data().nav,s=l.closest("[data-tab]");t&&t(),l.addClass("active").siblings("a").removeClass("active"),s.find("[data-con]").addClass("hidden").filter('[data-con="'+i+'"]').removeClass("hidden")},e=null;if($(".labels [data-tag]").click(function(){var a=$(this);t(a),e=a.data().tag;var l={sort:i,pageNo:1};myShowList(l),n(),$('.module-tab [data-nav="1"]').addClass("active").siblings("a").removeClass("active")}),$.nowNum=1,location.href.indexOf("#page=")>0){var l=location.href.match(/#page=(\d+)/)[1];isNaN(l)||($.nowNum=parseInt(l))}var i=0;$(".list-tab [data-nav]").click(function(){i=$(this).data().nav,0!=i?$(".area-date").css({display:"block"}):($(".area-date").css({display:"none"}),$(".area-calendar").css({display:"none"}));var a=$(this);t(a),myShowList({sort:i,pageNo:1})}),$(".module-tab [data-nav]").click(function(){var a=$(this);t(a)}),window.localStorage.setItem("color","default");var s=$("#third-view").children("a");if("th-large"==s.data().th){var d=window.localStorage.getItem("color");$("#third-view [data-th ='th-large']").addClass(d)}var o=$("#list-data");s.click(function(){var a=$(this);a.hasClass("default")||(s.filter(".default").removeClass("default"),a.addClass("default"),a.hasClass("default")&&"th-large"===a.data().th?window.localStorage.setItem("className","th-large"):a.hasClass("default")&&"th-list"===a.data().th?window.localStorage.setItem("className","th-list"):window.localStorage.setItem("className","th-normal"),add())}),add=function(){var a=window.localStorage.getItem("className");$("#third-view [data-th ='th-large']").removeClass(d),"th-list"==a?(o.removeClass("th-large th-normal").addClass(a),$("#third-view [data-th ='th-list']").addClass(d)):"th-normal"==a?(o.removeClass("th-large th-list").addClass(a),$("#third-view [data-th ='th-normal']").addClass(d)):(o.removeClass("th-normal th-list").addClass(a),$("#third-view [data-th ='th-large']").addClass(d))},add(),forDate=function(a){var t=a.split("-"),e=new Date(t[0],t[1]-1,t[2]).getTime();return e};var r=86399e3;myShowList=function(t){e&&(t.tagIds=e),0!=i&&(t.startDate=forDate($(".area-start-date").html()),t.endDate=forDate($(".area-end-date").html())+r),$("#list-video").html("<div id='emotion'><img src='"+window.globalConfig.oldPath+"/umeditor/dialogs/emotion/images/ac/"+$.randomNumber(1,54)+".gif'/><div id='list'>正在获取视频列表...</div></div>");var l,s;l={channelId:location.href.match(/\/[v|a]\/list(\d+)/)[1],sort:i,pageSize:20,pageNo:t.pageNo||1},s=$.extend({},l,t),$.ajax({type:"GET",url:"/list/getlist",data:s,dataType:"json",success:function(t){if(t.data.data.length>0){var l="";$.each(t.data.data,function(a,t){switch(t.verified){case 1:t.verifiedTitle="AcFun管理员";break;case 2:t.verifiedTitle="AcFun官方认证";break;default:t.verifiedTitle=""}l+=$.parseTemp($("#temp-list-video").html(),t)}),$("#list-video").html(l).find("img[data-original]").lazyload({threshold:200,effect:"fadeIn"}),t.data.params.num!=$.nowNum&&($.nowNum=t.data.params.num);var i=$.makePager({num:$.nowNum,count:t.data.params.totalCount,size:t.data.params.pageSize,total:t.data.params.pageCount,addon:!0});$("#list-pager").html(i),0==a&&($("#list-pager").readyPager({addon:!0,callback:function(a){return console.log(e),myShowList({pageNo:a})}}),a=1)}else $("#emotion div").html("暂无内容."),$("#list-pager").html(" ");scroll(0,0)},error:function(){$("#emotion div").html('<p class="alert info danger">获取视频列表失败，请于稍后重试。</p>'),$("#list-pager").html(" ")}})};var n=function(a){var t={channelId:location.href.match(/\/[v|a]\/list(\d+)/)[1],sort:1,range:1,page:1,size:5,tagIds:e};$.ajax({type:"GET",url:"/list/getrank",data:t,dataType:"json",success:function(a){$(".module-main").html(a.data).find("img[data-original]").lazyload({threshold:200,effect:"fadeIn"})}})};getData($.nowNum),$(".list-right-img").on("click",function(){sa.track("SanJiYeGuangGao",{channel:$.getvl("channel")||"",userLevel:$.user.getGroupLevel()?String($.user.getGroupLevel()):"-1",url:$(this).find("a").attr("href"),secchannelId:Number(location.pathname.split("list")[1].split("/")[0])})})});